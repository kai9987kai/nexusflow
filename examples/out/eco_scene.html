<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>EcoAIDashboard - Scene ecosystem_lab</title>
  <style>
    :root {
      --bg:#070b14; --panel:#0f172a; --line:#213049; --text:#e2e8f0; --muted:#94a3b8; --accent:#22d3ee;
    }
    * { box-sizing:border-box; }
    body { margin:0; font-family:Segoe UI,system-ui,sans-serif; background:radial-gradient(circle at 10% 10%, rgba(34,211,238,.15), transparent 45%), linear-gradient(180deg,#020617,var(--bg)); color:var(--text); }
    .wrap { max-width:1100px; margin:0 auto; padding:20px; }
    .hero { border:1px solid var(--line); border-radius:14px; padding:14px; background:rgba(15,23,42,.75); }
    .grid { display:grid; grid-template-columns: minmax(0, 1.2fr) minmax(0, .8fr); gap:14px; margin-top:14px; }
    .card { border:1px solid var(--line); border-radius:14px; padding:12px; background:rgba(15,23,42,.8); }
    h1,h2 { margin:0 0 10px; }
    h1 { font-size:22px; }
    h2 { font-size:14px; }
    .muted { color:var(--muted); }
    canvas { width:100%; height:360px; display:block; background:linear-gradient(180deg,#050a14,#0b1220); border:1px solid rgba(255,255,255,.06); border-radius:10px; }
    .kv { display:grid; grid-template-columns:1fr auto; gap:8px; font-size:13px; }
    .kv div { padding:4px 0; border-bottom:1px dashed rgba(148,163,184,.12); }
    pre { margin:0; font-size:12px; line-height:1.35; background:rgba(2,6,23,.55); border:1px solid rgba(255,255,255,.06); border-radius:10px; padding:10px; overflow:auto; max-height:360px; }
  </style>
</head>
<body>
  <div class="wrap">
    <section class="hero">
      <h1>EcoAIDashboard / scene3d "ecosystem_lab"</h1>
      <div class="muted">Native NexusFlow scene export (dependency-free preview; metadata-based visualizer)</div>
    </section>
    <section class="grid">
      <div class="card">
        <h2>Viewport Preview</h2>
        <canvas id="cv" width="640" height="360"></canvas>
      </div>
      <div class="card">
        <h2>Scene Summary</h2>
        <div class="kv" id="summary"></div>
      </div>
      <div class="card">
        <h2>Scene JSON</h2>
        <pre id="scene_json"></pre>
      </div>
      <div class="card">
        <h2>Assets JSON</h2>
        <pre id="assets_json"></pre>
      </div>
    </section>
  </div>
  <script>
    const scene = {
  "name": "ecosystem_lab",
  "template": "lab",
  "background": "#0b1020",
  "nodes": [
    {
      "name": "terrain",
      "asset": "terrain_tile",
      "kind": "mesh",
      "transform": {
        "position": [
          0.0,
          0.0,
          0.0
        ],
        "rotation": [
          0.0,
          0.0,
          0.0
        ],
        "scale": [
          2.0,
          1.0,
          2.0
        ]
      },
      "asset_kind": "obj",
      "asset_stats": {
        "vertices": 4,
        "normals": 1,
        "uvs": 4,
        "faces": 1,
        "triangles_estimate": 2,
        "objects": [
          "TerrainTile"
        ],
        "groups": [],
        "materials": [
          "Grass"
        ],
        "mtllibs": []
      },
      "bounds": {
        "min": [
          -1.0,
          0.0,
          -1.0
        ],
        "max": [
          1.0,
          0.0,
          1.0
        ],
        "size": [
          2.0,
          0.0,
          2.0
        ],
        "center": [
          0.0,
          0.0,
          0.0
        ]
      }
    },
    {
      "name": "scout_drone",
      "asset": "drone",
      "kind": "mesh",
      "transform": {
        "position": [
          1.5,
          1.2,
          -0.8
        ],
        "rotation": [
          0.0,
          0.0,
          0.0
        ],
        "scale": [
          1.0,
          1.0,
          1.0
        ]
      },
      "asset_kind": "gltf",
      "asset_stats": {
        "scenes": 1,
        "nodes": 1,
        "meshes": 1,
        "primitives": 1,
        "materials": 1,
        "animations": 0,
        "accessors": 0,
        "buffers": 0,
        "bufferViews": 0,
        "images": 0
      },
      "bounds": null
    }
  ],
  "lights": [
    {
      "kind": "hemisphere",
      "intensity": 0.9,
      "color": "#8ec5ff"
    }
  ],
  "camera": {
    "position": [
      4.5,
      3.0,
      8.0
    ],
    "target": [
      0.0,
      0.0,
      0.0
    ],
    "fov": 52.0
  },
  "created_at": "2026-02-26T15:37:19.664168+00:00"
};
    const assets = {
  "terrain_tile": {
    "name": "terrain_tile",
    "kind": "obj",
    "path": "C:\\Users\\kai99\\Desktop\\New folder (5)\\examples\\assets\\terrain_tile.obj",
    "bytes": 211,
    "stats": {
      "vertices": 4,
      "normals": 1,
      "uvs": 4,
      "faces": 1,
      "triangles_estimate": 2,
      "objects": [
        "TerrainTile"
      ],
      "groups": [],
      "materials": [
        "Grass"
      ],
      "mtllibs": []
    },
    "bounds": {
      "min": [
        -1.0,
        0.0,
        -1.0
      ],
      "max": [
        1.0,
        0.0,
        1.0
      ],
      "size": [
        2.0,
        0.0,
        2.0
      ],
      "center": [
        0.0,
        0.0,
        0.0
      ]
    },
    "loaded_at": "2026-02-26T15:37:19.663698+00:00"
  },
  "drone": {
    "name": "drone",
    "kind": "gltf",
    "path": "C:\\Users\\kai99\\Desktop\\New folder (5)\\examples\\assets\\drone.gltf",
    "bytes": 499,
    "asset": {
      "version": "2.0",
      "generator": "NexusFlow sample"
    },
    "stats": {
      "scenes": 1,
      "nodes": 1,
      "meshes": 1,
      "primitives": 1,
      "materials": 1,
      "animations": 0,
      "accessors": 0,
      "buffers": 0,
      "bufferViews": 0,
      "images": 0
    },
    "default_scene": 0,
    "extensions_used": [],
    "extensions_required": [],
    "loaded_at": "2026-02-26T15:37:19.664139+00:00"
  }
};
    const summary = document.getElementById('summary');
    const scenePairs = [
      ['template', scene.template || 'stage'],
      ['nodes', (scene.nodes || []).length],
      ['lights', (scene.lights || []).length],
      ['camera.fov', scene.camera?.fov ?? 50],
      ['assets', Object.keys(assets).length],
    ];
    for (const [k,v] of scenePairs) {
      const a = document.createElement('div'); a.className='muted'; a.textContent = k;
      const b = document.createElement('div'); b.textContent = String(v);
      summary.append(a,b);
    }
    document.getElementById('scene_json').textContent = JSON.stringify(scene, null, 2);
    document.getElementById('assets_json').textContent = JSON.stringify(assets, null, 2);
    const cv = document.getElementById('cv');
    const ctx = cv.getContext('2d');
    let t = 0;
    function draw() {
      const w = cv.width, h = cv.height;
      ctx.clearRect(0,0,w,h);
      ctx.fillStyle = '#081021';
      ctx.fillRect(0,0,w,h);
      ctx.strokeStyle = 'rgba(34,211,238,0.2)';
      for (let i=0;i<8;i++) {
        const y = (i+1)*h/9;
        ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(w,y); ctx.stroke();
      }
      const nodes = Array.isArray(scene.nodes) ? scene.nodes : [];
      nodes.forEach((node, idx) => {
        const pos = node?.transform?.position || [0,0,0];
        const x = Number(pos[0] || 0), y = Number(pos[1] || 0), z = Number(pos[2] || 0);
        const orbit = t * 0.0007 + idx * 1.2;
        const px = w/2 + (x*35 + Math.cos(orbit)*(18 + idx*3));
        const py = h/2 - (y*35 + Math.sin(orbit)*12) - z*8;
        const size = Math.max(4, 10 - z * 0.6);
        ctx.fillStyle = ['#22d3ee','#f59e0b','#86efac','#fb7185'][idx % 4];
        ctx.beginPath(); ctx.arc(px, py, size, 0, Math.PI*2); ctx.fill();
        ctx.strokeStyle = 'rgba(255,255,255,0.22)';
        ctx.stroke();
        ctx.fillStyle = 'rgba(226,232,240,0.9)';
        ctx.font = '12px Segoe UI, sans-serif';
        ctx.fillText(String(node.name || node.asset || ('node'+idx)), px + size + 4, py + 4);
      });
      t += 16;
      requestAnimationFrame(draw);
    }
    draw();
  </script>
</body>
</html>
